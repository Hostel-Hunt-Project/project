<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Register â€“ Hostel Hunt</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>

<header>
    <div class="logo">Hostel Hunt</div>
    <nav>
        <a href="index.html">Home</a>
        <a href="login.html">Login</a>
        <a href="register.html" class="btn">Sign up</a>
    </nav>
</header>

<div class="form-page">
    <h2>Create an Account</h2>
    <p class="small">Free sign-up for both students and property owners.</p>

    <form id="registerForm">
        <div class="form-group">
            <label>Full Name</label>
            <input type="text" name="name" placeholder="Your name" required>
        </div>

        <div class="form-group">
            <label>Email</label>
            <input type="email" name="email" placeholder="you@example.com" required>
        </div>

        <div class="form-group">
            <label>Phone</label>
            <input type="text" name="phone" placeholder="10 digit mobile">
        </div>

        <div class="form-group">
            <label>Password</label>
            <input type="password" name="password" required>
        </div>

        <div class="form-group">
            <label>Confirm Password</label>
            <input type="password" name="confirm_password" required>
        </div>

        <div class="form-group">
            <label>Register as</label>
            <select name="role">
                <option value="student">Student / Bachelor</option>
                <option value="owner">Owner</option>
            </select>
        </div>

        <div class="form-group">
            <label>Gender</label>
            <select name="gender">
                <option value="">Select</option>
                <option value="male">Male</option>
                <option value="female">Female</option>
                <option value="other">Other</option>
            </select>
        </div>

        <div class="form-group">
            <label>College / University (for students)</label>
            <input type="text" name="college_name" placeholder="e.g. XYZ University">
        </div>

        <div class="form-actions">
            <button type="submit" class="btn-primary">Create account</button>
            <a href="login.html" class="text-link">Already registered? Login</a>
        </div>

        <p id="registerMessage" class="small" style="margin-top:10px;"></p>
    </form>
</div>

<!-- First load Firebase.js -->
<script type="module" src="firebase.js"></script>

<!-- Then load Register Logic -->
<script type="module">
import { auth, db } from "./firebase.js";
import { createUserWithEmailAndPassword } from "https://www.gstatic.com/firebasejs/12.6.0/firebase-auth.js";
import { doc, setDoc, serverTimestamp } from "https://www.gstatic.com/firebasejs/12.6.0/firebase-firestore.js";

const form = document.getElementById("registerForm");
const msg = document.getElementById("registerMessage");

function showMessage(text, type = "success") {
  msg.innerText = text;
  msg.style.display = "block";
  msg.style.color = (type === "error") ? "red" : (type === "info" ? "blue" : "green");
}

form.addEventListener("submit", async (e) => {
  e.preventDefault();

  msg.innerText = "";

  const data = new FormData(form);

  const name = data.get("name");
  const email = data.get("email");
  const phone = data.get("phone");
  const password = data.get("password");
  const confirmPassword = data.get("confirm_password");
  const role = data.get("role");
  const gender = data.get("gender");
  const college = data.get("college_name");

  if (password !== confirmPassword) {
    showMessage("Passwords do not match!", "error");
    return;
  }

  try {
    const userCred = await createUserWithEmailAndPassword(auth, email, password);
    const uid = userCred.user.uid;

    await setDoc(doc(db, "users", uid), {
      name,
      email,
      phone,
      role,
      gender,
      college,
      createdAt: serverTimestamp()
    });

    showMessage("Account created! Redirecting...", "success");

    setTimeout(() => window.location.href = "login.html", 2000);

  } catch (err) {
    if (err.code === "auth/email-already-in-use") {
      showMessage("Email is already registered. Redirecting to login...", "info");
      setTimeout(() => window.location.href = "login.html", 2000);
    } else {
      showMessage("Firebase Error: " + err.message, "error");
    }
  }
});
</script>



</body>
</html>


